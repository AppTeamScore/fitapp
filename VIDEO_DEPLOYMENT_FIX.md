# Решение проблемы с видео файлами при деплое

## Проблема

При запуске приложения на сервере видео файлы не доступны, хотя локально через `npm run dev` все работает корректно.

## Причина проблемы

Видео файлы находятся в папке `public/videos/`, но при сборке Docker-образа они не копируются в финальный образ. Сервис деплоя (Platform.sh или аналогичный) использует стандартный процесс сборки, который не учитывает статические файлы вне папки сборки.

## Решение

### 1. Создан Dockerfile

Создан кастомный Dockerfile, который:
- Явно копирует видео файлы из `public/videos/` в `build/videos/`
- Использует nginx для обслуживания статических файлов
- Правильно настраивает маршрутизацию для React Router

### 2. Обновлен Vite конфиг

В `vite.config.ts` добавлена настройка для правильной обработки видео файлов:
- Видео файлы копируются в папку `build/videos/`
- Настроены правильные пути для статических ассетов

### 3. Создан nginx.conf

Конфигурация nginx для:
- Обработки маршрутов React Router
- Кэширования статических файлов
- Gzip сжатия

## Инструкции по использованию

### Локальная сборка и тестирование

1. Запустите сборку:
```bash
npm run build
```

2. Соберите Docker-образ:
```bash
chmod +x build-docker.sh
./build-docker.sh
```

3. Проверьте работу приложения:
```
http://localhost:8080
```

### Для деплоя на сервере

1. Используйте созданный Dockerfile для сборки образа
2. Убедитесь, что видео файлы находятся в `public/videos/`
3. При использовании Platform.sh или аналогичного сервиса, убедитесь, что Dockerfile включен в репозиторий

### Альтернативное решение

Если вы не можете использовать кастомный Dockerfile, можно:

1. Скопировать видео файлы из `src/videos/` в `public/videos/` перед сборкой
2. Добавить скрипт в package.json для копирования файлов:

```json
{
  "scripts": {
    "prebuild": "cp -r src/videos/* public/videos/ 2>/dev/null || true",
    "build": "vite build"
  }
}
```

## Проверка

После применения решения:
1. Видео файлы должны быть доступны по путям `/videos/video_XXX.mp4`
2. В компоненте VideoPlayer должна отображаться ошибка "Видео не найдено" только при отсутствии файла
3. Видео должны воспроизводиться корректно

## Дополнительные рекомендации

1. Регулярно проверяйте доступность видео файлов после деплоя
2. Мониторьте логи nginx для отладки проблем с доступом к видео
3. Используйте CDN для больших видео файлов для улучшения производительности